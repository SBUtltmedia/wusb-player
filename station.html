<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>


<br>


<script>
    var playerWin;
    window.name=`wusb_${Date.now()}`
    var currentIndex = 0;
    var songs =  [ {
      "name": "Blues at Dawn",
      "artist": "Blues at Dawn",
      "album": "SBU",
      "url": "https://stream.wusb.stonybrook.edu/content/3Wed-0700.1.mp3",
      "cover_art_url": "https://www.wusb.fm/themes/wusb/masthead.png"
    },  {
      "name": "Indecisive",
      "artist": "Indecisive",
      "album": "SBU",
      "url": " https://stream.wusb.stonybrook.edu/content/2Tue-1400.mp3",
      "cover_art_url": "https://www.wusb.fm/themes/wusb/masthead.png"
    }
]
songs.forEach((song)=>
{

    var button =  Object.assign(document.createElement('a'),{
        href:`javascript:addToPlaylist(${JSON.stringify(song)})`,
        innerHTML:song.name

    })
    document.body.append(button)
    document.body.append(document.createElement('br'))
})
    

function openPlayer() {
    if (typeof(playerWin) != 'object' || playerWin.closed) {
        playerWin = window.open("player.html");
           playerWin.postMessage( window.name)
           console.log("create widnow");
    } else {
            console.log("have window");
    }
    
}

    document.getElementById("openPlayer").onclick = openPlayer;



function addToPlaylist(song){
    if (!(typeof(playerWin) == 'object' && !playerWin.closed)) {

        openPlayer();
    }
console.log("DFSDSF")
    window.localStorage.setItem("songToAdd", JSON.stringify(song));
    playerWin.postMessage("");
}





</script>
</body>
</html>